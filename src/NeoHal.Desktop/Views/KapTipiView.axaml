<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:NeoHal.Desktop.ViewModels"
             x:Class="NeoHal.Desktop.Views.KapTipiView"
             x:DataType="vm:KapTipiViewModel">
    
    <Grid ColumnDefinitions="*, Auto">
        <!-- Sol: Liste -->
        <Grid Grid.Column="0" RowDefinitions="Auto, *, Auto">
            <!-- BaÅŸlÄ±k ve AraÃ§lar -->
            <Border Grid.Row="0" Background="{DynamicResource BackgroundMediumBrush}" Padding="15">
                <Grid ColumnDefinitions="*, Auto, Auto">
                    <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="15">
                        <TextBlock Text="ðŸ“¦ Kap Tipleri" FontSize="20" FontWeight="Bold" VerticalAlignment="Center"/>
                        <CheckBox Content="Sadece Aktifler" IsChecked="{Binding SadecekAktifler}" VerticalAlignment="Center"/>
                    </StackPanel>
                    <Button Grid.Column="2" Content="âž• Yeni Kap Tipi" Command="{Binding NewCommand}" 
                            Background="#4CAF50" Foreground="White" Padding="15,8"/>
                </Grid>
            </Border>

            <!-- DataGrid -->
            <DataGrid Grid.Row="1" 
                      ItemsSource="{Binding KapTipleri}" 
                      SelectedItem="{Binding SelectedKapTipi}"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      GridLinesVisibility="Horizontal"
                      BorderThickness="0">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Kod" Binding="{Binding Kod}" Width="100"/>
                    <DataGridTextColumn Header="Ad" Binding="{Binding Ad}" Width="*"/>
                    <DataGridTextColumn Header="Dara (Kg)" Binding="{Binding DaraAgirlik, StringFormat=N2}" Width="100"/>
                    <DataGridTextColumn Header="Rehin (â‚º)" Binding="{Binding RehinBedeli, StringFormat=N2}" Width="100"/>
                    <DataGridCheckBoxColumn Header="Aktif" Binding="{Binding Aktif}" Width="80"/>
                </DataGrid.Columns>
            </DataGrid>

            <!-- Alt bilgi -->
            <Border Grid.Row="2" Background="{DynamicResource BackgroundMediumBrush}" Padding="10">
                <TextBlock Text="{Binding KapTipleri.Count, StringFormat='Toplam: {0} kap tipi'}" 
                           FontSize="12" Foreground="#888"/>
            </Border>
        </Grid>

        <!-- SaÄŸ: Edit Panel -->
        <Border Grid.Column="1" Width="350" Background="{DynamicResource BackgroundMediumBrush}" 
                IsVisible="{Binding IsEditing}" Padding="20">
            <ScrollViewer>
                <StackPanel Spacing="15">
                    <TextBlock FontSize="18" FontWeight="Bold" Margin="0,0,0,10">
                        <TextBlock.Text>
                            <MultiBinding StringFormat="{}{0}">
                                <Binding Path="IsNew" />
                            </MultiBinding>
                        </TextBlock.Text>
                    </TextBlock>
                    <TextBlock Text="Kap Tipi DÃ¼zenle" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"
                               IsVisible="{Binding !IsNew}"/>
                    <TextBlock Text="Yeni Kap Tipi" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"
                               IsVisible="{Binding IsNew}"/>

                    <StackPanel Spacing="5">
                        <TextBlock Text="Kod *" FontSize="12" Foreground="#aaa"/>
                        <TextBox Text="{Binding EditKod}" Watermark="KAP001"/>
                    </StackPanel>

                    <StackPanel Spacing="5">
                        <TextBlock Text="Ad *" FontSize="12" Foreground="#aaa"/>
                        <TextBox Text="{Binding EditAd}" Watermark="Plastik Kasa"/>
                    </StackPanel>

                    <StackPanel Spacing="5">
                        <TextBlock Text="Dara AÄŸÄ±rlÄ±k (Kg)" FontSize="12" Foreground="#aaa"/>
                        <NumericUpDown Value="{Binding EditDaraAgirlik}" 
                                       Minimum="0" Maximum="100" 
                                       Increment="0.1"
                                       FormatString="N2"/>
                    </StackPanel>

                    <StackPanel Spacing="5">
                        <TextBlock Text="Rehin Bedeli (â‚º)" FontSize="12" Foreground="#aaa"/>
                        <NumericUpDown Value="{Binding EditRehinBedeli}" 
                                       Minimum="0" Maximum="1000" 
                                       Increment="1"
                                       FormatString="N2"/>
                    </StackPanel>

                    <CheckBox Content="Aktif" IsChecked="{Binding EditAktif}" Margin="0,10,0,0"/>

                    <Border Height="1" Background="#444" Margin="0,10"/>

                    <StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Right">
                        <Button Content="Ä°ptal" Command="{Binding CancelCommand}" 
                                Background="#666" Foreground="White" Padding="20,10"/>
                        <Button Content="Kaydet" Command="{Binding SaveCommand}" 
                                Background="#2196F3" Foreground="White" Padding="20,10"/>
                    </StackPanel>

                    <Button Content="ðŸ—‘ï¸ Sil" Command="{Binding DeleteCommand}" 
                            IsVisible="{Binding !IsNew}"
                            Background="#f44336" Foreground="White" 
                            HorizontalAlignment="Stretch" Padding="10" Margin="0,20,0,0"/>
                </StackPanel>
            </ScrollViewer>
        </Border>
    </Grid>
</UserControl>
