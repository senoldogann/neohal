<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:NeoHal.Desktop.ViewModels"
             x:Class="NeoHal.Desktop.Views.KasaHesabiView"
             x:DataType="vm:KasaHesabiViewModel">
    
    <Grid ColumnDefinitions="*, Auto">
        <!-- Sol: Liste -->
        <Grid Grid.Column="0" RowDefinitions="Auto, Auto, *, Auto">
            <!-- BaÅŸlÄ±k -->
            <Border Grid.Row="0" Background="{DynamicResource BackgroundMediumBrush}" Padding="15">
                <Grid ColumnDefinitions="*, Auto, Auto">
                    <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="15">
                        <TextBlock Text="ðŸ’° Kasa HesabÄ±" FontSize="20" FontWeight="Bold" VerticalAlignment="Center"/>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="Bakiye: " Foreground="#888" FontSize="14"/>
                            <TextBlock Text="â‚º" FontSize="16" Foreground="#4CAF50" FontWeight="Bold"/>
                            <TextBlock Text="{Binding KasaBakiye, StringFormat=0.00}" 
                                       FontSize="16" Foreground="#4CAF50" FontWeight="Bold"/>
                        </StackPanel>
                    </StackPanel>
                    <Button Grid.Column="1" Content="ðŸ”„ Yenile" Command="{Binding RefreshCommand}" 
                            Padding="15,8" Margin="0,0,10,0"/>
                    <Button Grid.Column="2" Content="âž• Yeni Hareket" Command="{Binding NewHareketCommand}" 
                            Background="#4CAF50" Foreground="White" Padding="15,8"/>
                </Grid>
            </Border>
            
            <!-- Filtre -->
            <Border Grid.Row="1" Background="{DynamicResource BackgroundDarkBrush}" Padding="15">
                <StackPanel Orientation="Horizontal" Spacing="15">
                    <TextBlock Text="Tarih AralÄ±ÄŸÄ±:" VerticalAlignment="Center" Foreground="#888"/>
                    <DatePicker SelectedDate="{Binding FiltreBaslangic}" Width="200"/>
                    <TextBlock Text="-" VerticalAlignment="Center"/>
                    <DatePicker SelectedDate="{Binding FiltreBitis}" Width="200"/>
                    <Button Content="Filtrele" Command="{Binding FilterCommand}" Padding="15,8"/>
                </StackPanel>
            </Border>
            
            <!-- DataGrid -->
            <DataGrid Grid.Row="2" 
                      ItemsSource="{Binding Hareketler}" 
                      SelectedItem="{Binding SelectedHareket}"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      GridLinesVisibility="Horizontal"
                      BorderThickness="0">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Tarih" Binding="{Binding Tarih, StringFormat=dd.MM.yyyy HH:mm}" Width="140"/>
                    <DataGridTextColumn Header="Ä°ÅŸlem" Binding="{Binding GirisHareketi}" Width="80"/>
                    <DataGridTextColumn Header="Tutar" Binding="{Binding Tutar, StringFormat=â‚º0.00}" Width="100"/>
                    <DataGridTextColumn Header="Ã–deme TÃ¼rÃ¼" Binding="{Binding OdemeTuru}" Width="100"/>
                    <DataGridTextColumn Header="Cari" Binding="{Binding Cari.Unvan}" Width="*"/>
                    <DataGridTextColumn Header="AÃ§Ä±klama" Binding="{Binding Aciklama}" Width="200"/>
                </DataGrid.Columns>
            </DataGrid>

            <!-- Alt bilgi -->
            <Border Grid.Row="3" Background="{DynamicResource BackgroundMediumBrush}" Padding="10">
                <Grid ColumnDefinitions="*,Auto">
                    <TextBlock Grid.Column="0" Text="{Binding StatusMessage}" Foreground="#888"/>
                    <Button Grid.Column="1" Content="ðŸ—‘ Sil" Command="{Binding DeleteHareketCommand}"
                            IsEnabled="{Binding SelectedHareket, Converter={x:Static ObjectConverters.IsNotNull}}"
                            Background="{DynamicResource ErrorBrush}" Foreground="White" Padding="15,8"/>
                </Grid>
            </Border>
        </Grid>

        <!-- SaÄŸ: Edit Panel -->
        <Border Grid.Column="1" Width="350" Background="{DynamicResource BackgroundMediumBrush}" 
                IsVisible="{Binding IsEditing}" Padding="20">
            <ScrollViewer>
                <StackPanel Spacing="15">
                    <TextBlock Text="Yeni Kasa Hareketi" FontSize="18" FontWeight="Bold" 
                               Foreground="White" Margin="0,0,0,10"/>
                    
                    <!-- Tarih -->
                    <StackPanel>
                        <TextBlock Text="Tarih" FontSize="12" Foreground="#888" Margin="0,0,0,5"/>
                        <DatePicker SelectedDate="{Binding YeniTarih}" HorizontalAlignment="Stretch"/>
                    </StackPanel>
                    
                    <!-- Ä°ÅŸlem Tipi -->
                    <StackPanel>
                        <TextBlock Text="Ä°ÅŸlem Tipi" FontSize="12" Foreground="#888" Margin="0,0,0,5"/>
                        <StackPanel Orientation="Horizontal" Spacing="20">
                            <RadioButton Content="GiriÅŸ" IsChecked="{Binding YeniGirisHareketi}" GroupName="Islem"/>
                            <RadioButton Content="Ã‡Ä±kÄ±ÅŸ" IsChecked="{Binding !YeniGirisHareketi}" GroupName="Islem"/>
                        </StackPanel>
                    </StackPanel>
                    
                    <!-- Tutar -->
                    <StackPanel>
                        <TextBlock Text="Tutar (â‚º) *" FontSize="12" Foreground="#888" Margin="0,0,0,5"/>
                        <NumericUpDown Value="{Binding YeniTutar}" Minimum="0" FormatString="0.00"/>
                    </StackPanel>
                    
                    <!-- Ã–deme TÃ¼rÃ¼ -->
                    <StackPanel>
                        <TextBlock Text="Ã–deme TÃ¼rÃ¼" FontSize="12" Foreground="#888" Margin="0,0,0,5"/>
                        <ComboBox ItemsSource="{Binding OdemeTurleri}" 
                                  SelectedItem="{Binding YeniOdemeTuru}"
                                  HorizontalAlignment="Stretch"/>
                    </StackPanel>
                    
                    <!-- Cari -->
                    <StackPanel>
                        <TextBlock Text="Cari Hesap (Opsiyonel)" FontSize="12" Foreground="#888" Margin="0,0,0,5"/>
                        <ComboBox ItemsSource="{Binding Cariler}" 
                                  SelectedItem="{Binding YeniCari}"
                                  HorizontalAlignment="Stretch"
                                  PlaceholderText="Cari seÃ§in...">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Unvan}"/>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </StackPanel>
                    
                    <!-- AÃ§Ä±klama -->
                    <StackPanel>
                        <TextBlock Text="AÃ§Ä±klama" FontSize="12" Foreground="#888" Margin="0,0,0,5"/>
                        <TextBox Text="{Binding YeniAciklama}" 
                                 Watermark="Not ekleyin..."
                                 TextWrapping="Wrap"
                                 AcceptsReturn="True"
                                 Height="80"/>
                    </StackPanel>
                    
                    <!-- Butonlar -->
                    <Grid ColumnDefinitions="*,*" Margin="0,20,0,0">
                        <Button Grid.Column="0" Content="Ä°ptal" Command="{Binding CancelEditCommand}"
                                HorizontalAlignment="Stretch" Margin="0,0,5,0" Padding="15,10"/>
                        <Button Grid.Column="1" Content="ðŸ’¾ Kaydet" Command="{Binding SaveHareketCommand}"
                                Background="#4CAF50" Foreground="White"
                                HorizontalAlignment="Stretch" Margin="5,0,0,0" Padding="15,10"/>
                    </Grid>
                </StackPanel>
            </ScrollViewer>
        </Border>
    </Grid>
</UserControl>
