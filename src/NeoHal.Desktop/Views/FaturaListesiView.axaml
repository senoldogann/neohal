<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:NeoHal.Desktop.ViewModels"
             x:Class="NeoHal.Desktop.Views.FaturaListesiView"
             x:DataType="vm:FaturaListesiViewModel">
    
    <Grid RowDefinitions="Auto,Auto,*,Auto">
        <!-- BaÅŸlÄ±k -->
        <Border Grid.Row="0" Background="{DynamicResource BackgroundMediumBrush}" Padding="20,15" BorderBrush="#E5E5E5" BorderThickness="0,0,0,1">
            <Grid ColumnDefinitions="Auto,*,Auto">
                <StackPanel Orientation="Horizontal" Spacing="10">
                    <TextBlock Text="ðŸ“„" FontSize="24"/>
                    <TextBlock Text="FATURA LÄ°STESÄ°" FontSize="20" FontWeight="Bold" 
                               VerticalAlignment="Center" Foreground="{DynamicResource TextPrimaryBrush}"/>
                </StackPanel>
                
                <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="10">
                    <TextBlock Text="{Binding ToplamFaturaSayisi, StringFormat='Toplam: {0} fatura'}" 
                               Foreground="{DynamicResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Filtreler -->
        <Border Grid.Row="1" Background="White" Padding="15" BorderBrush="#E5E5E5" BorderThickness="0,0,0,1">
            <Grid ColumnDefinitions="Auto,200,30,Auto,200,30,Auto,200,30,Auto,*,Auto">
                <TextBlock Text="Tarih:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                <DatePicker Grid.Column="1" SelectedDate="{Binding BaslangicTarihi}"/>
                
                <TextBlock Grid.Column="3" Text="-" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                <DatePicker Grid.Column="4" SelectedDate="{Binding BitisTarihi}"/>
                
                <TextBlock Grid.Column="6" Text="MÃ¼ÅŸteri:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                <ComboBox Grid.Column="7" 
                          ItemsSource="{Binding Musteriler}"
                          SelectedItem="{Binding SeciliMusteri}"
                          PlaceholderText="TÃ¼m mÃ¼ÅŸteriler..."
                          IsTextSearchEnabled="True">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Unvan}"/>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
                
                <TextBlock Grid.Column="9" Text="Ara:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                <TextBox Grid.Column="10" Text="{Binding AramaMetni}" 
                         Watermark="Fatura no, aÃ§Ä±klama..." Margin="0,0,10,0"/>
                
                <Button Grid.Column="11" Content="ðŸ” Ara" Command="{Binding AraCommand}"
                        Background="{DynamicResource PrimaryLightBrush}" Foreground="White" Padding="15,8"/>
            </Grid>
        </Border>
        
        <!-- Fatura Listesi -->
        <Border Grid.Row="2" Background="White" Padding="10">
            <Grid RowDefinitions="*,Auto">
                <DataGrid ItemsSource="{Binding Faturalar}"
                          SelectedItem="{Binding SeciliFatura}"
                          AutoGenerateColumns="False"
                          CanUserResizeColumns="True"
                          CanUserReorderColumns="False"
                          GridLinesVisibility="Horizontal"
                          BorderThickness="1"
                          BorderBrush="#E5E5E5"
                          IsReadOnly="True"
                          SelectionMode="Single"
                          Background="White"
                          RowBackground="White">
                    
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Fatura No" Width="140" MinWidth="100" Binding="{Binding FaturaNo}"/>
                        <DataGridTextColumn Header="Tarih" Width="100" MinWidth="80" 
                                            Binding="{Binding FaturaTarihi, StringFormat='{}{0:dd.MM.yyyy}'}"/>
                        <DataGridTextColumn Header="MÃ¼ÅŸteri" Width="250" MinWidth="120" Binding="{Binding Alici.Unvan}"/>
                        <DataGridTextColumn Header="Tutar (â‚º)" Width="120" MinWidth="90" 
                                            Binding="{Binding GenelToplam, StringFormat=N2}"
                                            Foreground="#4CAF50" FontWeight="Bold"/>
                        <DataGridTextColumn Header="Durum" Width="100" MinWidth="70" Binding="{Binding Durum}"/>
                    </DataGrid.Columns>
                </DataGrid>
                
                <!-- SeÃ§ili fatura iÃ§in iÅŸlem butonlarÄ± -->
                <Border Grid.Row="1" Background="{DynamicResource BackgroundMediumBrush}" Padding="10" Margin="0,10,0,0"
                        IsVisible="{Binding SeciliFatura, Converter={x:Static ObjectConverters.IsNotNull}}"
                        BorderBrush="#E5E5E5" BorderThickness="1" CornerRadius="6">
                    <StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Center">
                        <Button Content="âœï¸ DÃ¼zenle" Command="{Binding DuzenleSeciliCommand}"
                                Background="#2196F3" Foreground="White" Padding="15,8"/>
                        <Button Content="ðŸ–¨ YazdÄ±r" Command="{Binding YazdirSeciliCommand}"
                                Background="#4CAF50" Foreground="White" Padding="15,8"/>
                        <Button Content="ðŸ“„ PDF Ã–nizle" Command="{Binding PdfSeciliCommand}"
                                Background="{DynamicResource WarningBrush}" Foreground="White" Padding="15,8"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>
        
        <!-- Alt Ã–zet -->
        <Border Grid.Row="3" Background="White" Padding="15" BorderBrush="#E5E5E5" BorderThickness="0,1,0,0">
            <Grid ColumnDefinitions="*,Auto,Auto,Auto,Auto">
                <TextBlock Text="{Binding StatusMessage}" Foreground="{DynamicResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="20" Margin="0,0,30,0">
                    <StackPanel>
                        <TextBlock Text="Toplam Kap" Foreground="{DynamicResource TextSecondaryBrush}" FontSize="11"/>
                        <TextBlock Text="{Binding ToplamKapOzet}" FontSize="16" Foreground="{DynamicResource TextPrimaryBrush}"/>
                    </StackPanel>
                    <StackPanel>
                        <TextBlock Text="Toplam Kg" Foreground="{DynamicResource TextSecondaryBrush}" FontSize="11"/>
                        <TextBlock Text="{Binding ToplamKgOzet, StringFormat=N2}" FontSize="16" Foreground="{DynamicResource TextPrimaryBrush}"/>
                    </StackPanel>
                    <StackPanel>
                        <TextBlock Text="Toplam Tutar" Foreground="{DynamicResource TextSecondaryBrush}" FontSize="11"/>
                        <TextBlock Text="{Binding ToplamTutarOzet, StringFormat=â‚º{0:N2}}" 
                                   FontSize="18" FontWeight="Bold" Foreground="#4CAF50"/>
                    </StackPanel>
                </StackPanel>
                
                <Button Grid.Column="4" Content="â†» Yenile" Command="{Binding YenileCommand}"
                        Background="{DynamicResource BackgroundMediumBrush}" Foreground="{DynamicResource TextPrimaryBrush}" Padding="15,8"/>
            </Grid>
        </Border>
    </Grid>
</UserControl>
